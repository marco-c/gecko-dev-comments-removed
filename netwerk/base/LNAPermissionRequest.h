





#ifndef LNAPermissionRequest_h_
#define LNAPermissionRequest_h_
#include "nsContentPermissionHelper.h"
#include "nsISupports.h"
#include "nsPIDOMWindow.h"

namespace mozilla::net {
static constexpr nsLiteralCString LOCAL_HOST_PERMISSION_KEY = "localhost"_ns;
static constexpr nsLiteralCString LOCAL_NETWORK_PERMISSION_KEY =
    "local-network"_ns;

using PermissionPromptCallback =
    std::function<void(bool granted, const nsACString& type, bool promptShown)>;




class LNAPermissionRequest final : public dom::ContentPermissionRequestBase {
 public:
  LNAPermissionRequest(PermissionPromptCallback&& aCallback,
                       nsILoadInfo* aLoadInfo, const nsACString& aType);

  NS_DECL_ISUPPORTS_INHERITED
  NS_DECL_CYCLE_COLLECTION_CLASS_INHERITED(LNAPermissionRequest,
                                           ContentPermissionRequestBase)

  
  NS_IMETHOD
  Cancel(void) override;
  NS_IMETHOD Allow(JS::Handle<JS::Value> choices) override;
  NS_IMETHOD NotifyShown(void) override;
  NS_IMETHOD GetElement(mozilla::dom::Element** aElement) override;

  nsresult RequestPermission();

 private:
  ~LNAPermissionRequest() = default;
  nsCOMPtr<nsILoadInfo> mLoadInfo;
  PermissionPromptCallback mPermissionPromptCallback;
  bool mPromptWasShown = false;
};

}  

#endif  
