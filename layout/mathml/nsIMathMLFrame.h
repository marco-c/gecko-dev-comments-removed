




#ifndef nsIMathMLFrame_h___
#define nsIMathMLFrame_h___

#include "nsMathMLOperators.h"
#include "nsQueryFrame.h"

struct nsPresentationData;
struct nsEmbellishData;
class gfxContext;
class nsIFrame;
namespace mozilla {
class ReflowOutput;
}  



enum eMathMLFrameType {
  eMathMLFrameType_UNKNOWN = -1,
  eMathMLFrameType_Ordinary,
  eMathMLFrameType_OperatorOrdinary,
  eMathMLFrameType_OperatorInvisible,
  eMathMLFrameType_OperatorUserDefined,
  eMathMLFrameType_Inner,
  eMathMLFrameType_ItalicIdentifier,
  eMathMLFrameType_UprightIdentifier,
  eMathMLFrameType_COUNT
};



enum class MathMLPresentationFlag : uint8_t {
  
  
  Compressed,

  
  
  
  
  StretchAllChildrenVertically,

  
  
  
  
  StretchAllChildrenHorizontally,

  
  SpaceLike,

  
  
  Dtls,

  
  StretchDone,
};
using MathMLPresentationFlags = mozilla::EnumSet<MathMLPresentationFlag>;


class nsIMathMLFrame {
 public:
  NS_DECL_QUERYFRAME_TARGET(nsIMathMLFrame)

  
  virtual bool IsSpaceLike() = 0;

  
  

  







  NS_IMETHOD
  GetBoundingMetrics(nsBoundingMetrics& aBoundingMetrics) = 0;

  NS_IMETHOD
  SetBoundingMetrics(const nsBoundingMetrics& aBoundingMetrics) = 0;

  NS_IMETHOD
  SetReference(const nsPoint& aReference) = 0;

  virtual eMathMLFrameType GetMathMLFrameType() = 0;

  
  

  
















  NS_IMETHOD
  Stretch(mozilla::gfx::DrawTarget* aDrawTarget,
          nsStretchDirection aStretchDirection,
          nsBoundingMetrics& aContainerSize,
          mozilla::ReflowOutput& aDesiredStretchSize) = 0;

  

  NS_IMETHOD
  GetEmbellishData(nsEmbellishData& aEmbellishData) = 0;

  
  

  

  NS_IMETHOD
  GetPresentationData(nsPresentationData& aPresentationData) = 0;

  








































  NS_IMETHOD
  InheritAutomaticData(nsIFrame* aParent) = 0;

  NS_IMETHOD
  TransmitAutomaticData() = 0;

  



















  NS_IMETHOD
  UpdatePresentationData(MathMLPresentationFlags aFlagsValues,
                         MathMLPresentationFlags aWhichFlags) = 0;

  




















  NS_IMETHOD
  UpdatePresentationDataFromChildAt(int32_t aFirstIndex, int32_t aLastIndex,
                                    MathMLPresentationFlags aFlagsValues,
                                    MathMLPresentationFlags aWhichFlags) = 0;

  
  
  
  
  virtual uint8_t ScriptIncrement(nsIFrame* aFrame) = 0;

  
  
  
  
  virtual bool IsMrowLike() = 0;
};






struct nsEmbellishData {
  
  uint32_t flags = 0;

  
  nsIFrame* coreFrame = nullptr;

  
  nsStretchDirection direction = NS_STRETCH_DIRECTION_UNSUPPORTED;

  
  
  
  
  nscoord leadingSpace = 0;
  nscoord trailingSpace = 0;
};









struct nsPresentationData {
  
  MathMLPresentationFlags flags;

  
  
  
  nsIFrame* baseFrame = nullptr;
};






#define NS_MATHML_EMBELLISH_OPERATOR 0x00000001



#define NS_MATHML_EMBELLISH_MOVABLELIMITS 0x00000002



#define NS_MATHML_EMBELLISH_ACCENT 0x00000004



#define NS_MATHML_EMBELLISH_ACCENTOVER 0x00000008



#define NS_MATHML_EMBELLISH_ACCENTUNDER 0x00000010


#define NS_MATHML_EMBELLISH_FENCE 0x00000020


#define NS_MATHML_EMBELLISH_SEPARATOR 0x00000040



#define NS_MATHML_IS_EMBELLISH_OPERATOR(_flags) \
  (NS_MATHML_EMBELLISH_OPERATOR == ((_flags) & NS_MATHML_EMBELLISH_OPERATOR))

#define NS_MATHML_EMBELLISH_IS_MOVABLELIMITS(_flags) \
  (NS_MATHML_EMBELLISH_MOVABLELIMITS ==              \
   ((_flags) & NS_MATHML_EMBELLISH_MOVABLELIMITS))

#define NS_MATHML_EMBELLISH_IS_ACCENT(_flags) \
  (NS_MATHML_EMBELLISH_ACCENT == ((_flags) & NS_MATHML_EMBELLISH_ACCENT))

#define NS_MATHML_EMBELLISH_IS_ACCENTOVER(_flags) \
  (NS_MATHML_EMBELLISH_ACCENTOVER ==              \
   ((_flags) & NS_MATHML_EMBELLISH_ACCENTOVER))

#define NS_MATHML_EMBELLISH_IS_ACCENTUNDER(_flags) \
  (NS_MATHML_EMBELLISH_ACCENTUNDER ==              \
   ((_flags) & NS_MATHML_EMBELLISH_ACCENTUNDER))

#define NS_MATHML_EMBELLISH_IS_FENCE(_flags) \
  (NS_MATHML_EMBELLISH_FENCE == ((_flags) & NS_MATHML_EMBELLISH_FENCE))

#define NS_MATHML_EMBELLISH_IS_SEPARATOR(_flags) \
  (NS_MATHML_EMBELLISH_SEPARATOR == ((_flags) & NS_MATHML_EMBELLISH_SEPARATOR))

#endif 
