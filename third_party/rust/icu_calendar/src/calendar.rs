



use calendrical_calculations::rata_die::RataDie;

use crate::cal::iso::IsoDateInner;
use crate::error::{DateError, DateFromFieldsError};
use crate::options::DateFromFieldsOptions;
use crate::options::{DateAddOptions, DateDifferenceOptions};
use crate::{types, Iso};
use core::fmt;
















pub trait Calendar: crate::cal::scaffold::UnstableSealed {
    
    
    
    type DateInner: Eq + Copy + PartialOrd + fmt::Debug;
    
    type Year: fmt::Debug + Into<types::YearInfo>;
    
    type DifferenceError;

    
    
    
    #[expect(clippy::wrong_self_convention)]
    fn from_codes(
        &self,
        era: Option<&str>,
        year: i32,
        month_code: types::MonthCode,
        day: u8,
    ) -> Result<Self::DateInner, DateError>;

    
    
    
    
    
    
    
    
    
    
    #[expect(clippy::wrong_self_convention)]
    #[cfg(feature = "unstable")]
    fn from_fields(
        &self,
        fields: types::DateFields,
        options: DateFromFieldsOptions,
    ) -> Result<Self::DateInner, DateFromFieldsError>;

    
    
    fn has_cheap_iso_conversion(&self) -> bool;

    
    
    
    #[expect(clippy::wrong_self_convention)]
    fn from_iso(&self, iso: IsoDateInner) -> Self::DateInner {
        self.from_rata_die(Iso.to_rata_die(&iso))
    }
    
    
    
    fn to_iso(&self, date: &Self::DateInner) -> IsoDateInner {
        Iso.from_rata_die(self.to_rata_die(date))
    }

    
    #[expect(clippy::wrong_self_convention)]
    fn from_rata_die(&self, rd: RataDie) -> Self::DateInner;
    
    fn to_rata_die(&self, date: &Self::DateInner) -> RataDie;

    
    
    fn months_in_year(&self, date: &Self::DateInner) -> u8;
    
    
    fn days_in_year(&self, date: &Self::DateInner) -> u16;
    
    
    fn days_in_month(&self, date: &Self::DateInner) -> u8;
    
    fn is_in_leap_year(&self, date: &Self::DateInner) -> bool;

    
    fn year_info(&self, date: &Self::DateInner) -> Self::Year;

    
    fn extended_year(&self, date: &Self::DateInner) -> i32 {
        self.year_info(date).into().extended_year()
    }
    
    fn month(&self, date: &Self::DateInner) -> types::MonthInfo;
    
    fn day_of_month(&self, date: &Self::DateInner) -> types::DayOfMonth;
    
    fn day_of_year(&self, date: &Self::DateInner) -> types::DayOfYear;

    
    
    
    
    
    
    
    
    
    
    #[cfg(feature = "unstable")]
    fn add(
        &self,
        date: &Self::DateInner,
        duration: types::DateDuration,
        options: DateAddOptions,
    ) -> Result<Self::DateInner, DateError>;

    
    
    
    
    
    
    
    
    
    
    
    
    
    #[cfg(feature = "unstable")]
    fn until(
        &self,
        date1: &Self::DateInner,
        date2: &Self::DateInner,
        options: DateDifferenceOptions,
    ) -> Result<types::DateDuration, Self::DifferenceError>;

    
    
    
    
    fn calendar_algorithm(&self) -> Option<crate::preferences::CalendarAlgorithm>;

    
    fn debug_name(&self) -> &'static str;
}
