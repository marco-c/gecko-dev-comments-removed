






































asyncTest(async function() {
  class MyError extends Error {}
  const error1 = new MyError();
  const error2 = new MyError();
  const error3 = new MyError();

  try {
    await using _1 = { async [Symbol.asyncDispose]() { throw error1; } };
    await using _2 = { [Symbol.dispose]() { throw error2; } };
    throw error3;
  }
  catch (e) {
    assert(e instanceof SuppressedError, "Expected an SuppressedError to have been thrown");
    assert.sameValue(e.error, error1, "Expected the outermost suppressing error to have been 'error1'");
    assert(e.suppressed instanceof SuppressedError, "Expected the outermost suppressed error to have been a SuppressedError");
    assert.sameValue(e.suppressed.error, error2, "Expected the innermost suppressing error to have been 'error2'");
    assert.sameValue(e.suppressed.suppressed, error3, "Expected the innermost suppressed error to have been 'error3'");
  }
});
