



"use strict";








if (
  navigator.mediaDevices?.getDisplayMedia &&
  !window.__firefoxWebCompatFixBug2000906
) {
  Object.defineProperty(window, "__firefoxWebCompatFixBug2000906", {
    configurable: false,
    value: true,
  });

  console.info(
    'getDisplayMedia has been modified to drop resizeMode: "none" for compatibility reasons. See https://bugzilla.mozilla.org/show_bug.cgi?id=2000906 for details.'
  );

  function maybeDeleteResizeMode(video) {
    const { resizeMode, width, height, frameRate } = video;
    if (resizeMode == "none" && (width || height || frameRate)) {
      delete video.resizeMode;
    }
  }

  {
    const { prototype } = MediaDevices;
    const { getDisplayMedia: gDM } = prototype;
    prototype.getDisplayMedia = function getDisplayMedia(options) {
      const { video } = options || {};
      if (video) {
        maybeDeleteResizeMode(video);
      }
      return gDM.call(this, options);
    };
  }

  {
    const { prototype } = MediaStreamTrack;
    const { applyConstraints: aC } = prototype;
    prototype.applyConstraints = function applyConstraints(constraints) {
      
      
      
      if (!this.getConstraints().resizeMode) {
        maybeDeleteResizeMode(constraints || {});
      }
      return aC.call(this, constraints);
    };
  }
}
