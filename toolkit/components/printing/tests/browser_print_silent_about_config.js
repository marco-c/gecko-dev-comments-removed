


"use strict";

add_task(async function test_print_silent_about_config() {
  
  
  
  await SpecialPowers.pushPrefEnv({
    set: [["print.always_print_silent", true]],
  });

  await BrowserTestUtils.withNewTab("about:config", async browser => {
    await SpecialPowers.spawn(browser, [], async () => {
      await new Promise(r => {
        content.addEventListener("afterprint", r, { once: true });
        content.print();
      });
    });
  });

  info("waiting for print process to finish");
  
  await BrowserTestUtils.waitForMutationCondition(
    document.documentElement,
    { childList: true },
    () => {
      return !document.querySelector(":root > browser");
    }
  );

  ok(true, "Didn't crash, hopefully");
});
