





#ifndef mozilla_glean_GleanCounter_h
#define mozilla_glean_GleanCounter_h

#include "mozilla/dom/BindingDeclarations.h"
#include "mozilla/glean/bindings/CounterStandalone.h"
#include "mozilla/glean/bindings/GleanMetric.h"
#include "mozilla/Maybe.h"
#include "mozilla/Result.h"
#include "nsString.h"

namespace mozilla::glean {

namespace impl {

template <CounterType C = CounterType::eBaseOrLabeled>
class CounterMetric : public CounterStandalone<C> {
 public:
  constexpr explicit CounterMetric(uint32_t aId) : CounterStandalone<C>(aId) {}

  
















  Result<Maybe<int32_t>, nsCString> TestGetValue(
      const nsACString& aPingName = nsCString()) const;
};
}  

class GleanCounter final : public GleanMetric {
 public:
  explicit GleanCounter(
      uint32_t id, nsISupports* aParent,
      impl::CounterType aType = impl::CounterType::eBaseOrLabeled)
      : GleanMetric(aParent), mId(id), mType(aType) {}

  virtual JSObject* WrapObject(
      JSContext* aCx, JS::Handle<JSObject*> aGivenProto) override final;

  void Add(int32_t aAmount);

  dom::Nullable<int32_t> TestGetValue(const nsACString& aPingName,
                                      ErrorResult& aRv);

 private:
  virtual ~GleanCounter() = default;

  const uint32_t mId;
  const impl::CounterType mType;
};

}  

#endif 
